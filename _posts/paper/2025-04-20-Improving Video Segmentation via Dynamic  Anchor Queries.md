---
layout: post
title: 'Improving Video Segmentation via Dynamic  Anchor Queries ECCV 2024😊'
subtitle: '通过动态锚框查询提神视频分割'
date: 2025-04-20
author: Sun
cover: 'https://pic1.imgdb.cn/item/6803371758cb8da5c8b4a661.png'
tags: 论文阅读
---

> [Improving Video Segmentation via Dynamic  Anchor Queries](https://www.ecva.net/papers/eccv_2024/papers_ECCV/papers/06733.pdf)

> 💐💐[提供代码](https://zhang-tao-whu.github.io/projects/DVIS_DAQ/)
> 
> 📌作者单位
> 
> 1. 武汉大学
> 2. Skywork AI

# 1.文章针对痛点

这篇文章关注的是视频分割问题，也就是视频分割任务的目的是同时识别、分割以及追踪视频中所有感兴趣的物体。

文章提到现有的视频分割方法采用的是在锚框和目标查询之间特征转化的方法来实现跨帧的物体关联，使用这种方式在锚框和目标查询之间平和特征转化，可以达到令人满意的效果（当追踪持续出现的物体时）。

但是文章认为这种基于查询的方法有一个明显的限制：**它们在处理新出现或消失物体时，往往表现不佳**。文章认为这种现象可能是由于现有的方法，在面向新出现或消失的物体时，**依赖的是不可靠的锚框查询**。也就是说对于新出现的物体，锚框查询是一个背景查询，而目标查询确实物体的特征查询；而对于消失的物体，锚框查询是物体的特征查询，而目标查询应该是一个背景查询。<mark>而在背景和前景查询之间的特征转化鸿沟为锚框和目标查询之间的平滑转换带来了极大的挑战。</mark>

总而言之，这篇文章的出发点就是提升模型的鲁棒性，能良好的处理新出现物体和消失物体的分割。避免出现未识别到新出现的物体，或仍然识别消失物体。

# 2.主要贡献

为了解决上面提到的这些问题，文章提出了**一种动态锚框查询机制*DAQ* 来检测新出现和消失的物体**。具体来说，文章会将当前帧检测到的所有物体作为新出现物体的候选者，并使用这些候选者的特征来动态生成新出现锚框查询。另一方面，类似的做法，指定所有追踪物体作为消失物体的候选者，并使用它们的特征来动态生成消失物体的锚框查询。

此外，为了进一步利用模型的能力，文章还提出了**训练期间模拟策略*EDS***，对于新出现和消失物体。简而言之，就是通过认为的去除一些物体，来模拟新出现或者消失物体的情形。

原文总结贡献如下:

1. 我们发现，由于前景查询和背景查询之间存在相当大的过渡差距，目前基于查询的方法在管理对象的出现和消失方面存在不足。我们提出了一种动态锚点查询（*DAQ* ）机制来应对这一挑战。*DAQ* 机制可为对象的出现和消失动态生成锚点查询，从而缩短间隙并有效克服这一挑战。
2. 为了进一步释放 *DAQ* 机制的潜力，我们引入了 “出现和消失模拟”（*EDS* ）策略。这种简单高效的方法放大了出现和消失案例的数量，从而确保了 *DAQ* 的全面训练。
3. 通过整合我们提出的 *DAQ* 机制和 *EDS* 策略，我们改进了 *SOTA* 视频分割方法 *DVIS*，从而形成了 *DVIS-DAQ*。通过对五个视频分割基准的广泛实验，*DVIS-DAQ* 在所有基准上都取得了新的 *SOTA* 性能。我们进一步介绍了详细的消融研究，以验证每个组件的有效性。

# 3.实现流程

一样，还是先看一下原文展示的模型架构图：
![模型架构图2](https://pic1.imgdb.cn/item/6804547a58cb8da5c8b7bbb4.png)
![模型架构图](https://pic1.imgdb.cn/item/68033f7058cb8da5c8b4cfb8.png)

因为文章使用了其他方法作为论文的*baseline*，因此文章中并没有展示很详细的模型架构图，还提供了一个文章方法与其他方法的差异对比图。

# 4.实现细节

* **动态锚框查询**：这个模块是文章出发点的重要模块，包含新出现物体的动态锚框查询和消失物体的动态锚框查询。1️⃣**新出现物体的动态锚框查询**。与前面提到的一样，文章会将当前帧所有检测到物体作为新出现物体的候选者，并基于这些候选者的特征生成动态的锚框查询$${DAQ}_{Emg}$$。$${DAQ}_{Emg}$$包含两部分内容，分别是$$\mathrm{DAQ}_{E m g}^{f e a t}$$和$$\mathrm{DAQ}_{E m g}^{pos}$$。前者是所有动态锚框查询共享的一个可学习嵌入空间，后者是使用掩码$$\mathrm{F}_{mask}^{T}$$生成的位置编码。掩码生成如下公式1。2️⃣**消失物体的动态锚框查询**。与之前提到一样，文章会将所有追踪物体作为消失物体的候选者。与新出现物体一样，基于这些候选者的特征生成动态的锚框查询$${DAQ}_{Dis}$$。$${DAQ}_{Dis}$$包含两部分内容，分别是$$\mathrm{DAQ}_{Dis}^{f e a t}$$和$$\mathrm{DAQ}_{Dis}^{pos}$$。其中，使用$$\bar{F}_{\text {mask }}^{T}$$作为位置编码部分，其公式如下2 3 。3️⃣**持续跟踪查询**。这个其实并不属于动态锚框查询，这个查询记录的是一些一直存在的物体，但是为了匹配前面两个动态锚框查询的格式，因为这部分查询也包含两部分，与上面类似。
  
  $$
  F_{mask}^T=\mathrm{MLP}(\text{MaskPooling}(F^T,\mathcal{M}^T)),	\quad(1)
  $$
  
  $$
  \overline{F}_{mask}^T=(1-\beta)\overline{F}_{mask}^{T-1}+\beta F_{mask}^T \quad(2)
  $$
  
  $$
  \beta=\max\left(0,\frac{1}{T}\sum_{t=1}^{T-1}cosine(F_{mask}^t,F_{mask}^T)\right)	\quad(3)
  $$
* **整合动态锚框查询到追踪器**：这个部分包含两个追踪器，追踪器1用于处理新出现物体，而追踪器2用于处理消失物体。文章针对这个部分给出了一个示意图，如下。![示意图](https://pic1.imgdb.cn/item/6804557958cb8da5c8b7bed0.png)
* **新出现和消失物体模拟**：这个部分前面也已经提到过了，是为了充分利用模型的能力。同样也是包含新出现物体模拟和消失物体模拟，针对这部分，文章也给出了一个示意图，如下。这个地方需要注意的就是在新出现物体模拟和消失物体模拟中使用到的查询特征是不一样的，前者使用了*CTQ*，也就是持续存在物体的查询；而后者使用的$$Q_{seg}$$，也就是当前帧检测到的物体特征。![示意图](https://pic1.imgdb.cn/item/680455ea58cb8da5c8b7c090.png)

# 5.模型性能

文章最后使用到的损失公式如下所示：

$$
\mathcal{L}(\mathcal{P}, \mathcal{G})=\lambda_{\text {cls }} \mathcal{L}_{\text {cls }}(\mathcal{P}, \mathcal{G})+\lambda_{\text {dice }} \mathcal{L}_{\text {dice }}(\mathcal{P}, \mathcal{G})+\lambda_{\text {bce }} \mathcal{L}_{\text {bce }}(\mathcal{P}, \mathcal{G})
$$

实验性能效果对比图：![效果对比图1](https://pic1.imgdb.cn/item/680456e358cb8da5c8b7c45c.png)
![效果对比图2](https://pic1.imgdb.cn/item/6804570c58cb8da5c8b7c4e8.png)

# 6.改进/挑战/问题/想法

* **想法**：这篇文章和我的研究方向并不是完全相同，因为一开始看到这个题目以为视频分割是分割视频片段，所以。这个文章的出发点挺好的，但是感觉在我的方向上并不是十分使用，因为这个检测的实例还是很多的，但是在时刻检索这方面，对应的实例还是相同较少。

