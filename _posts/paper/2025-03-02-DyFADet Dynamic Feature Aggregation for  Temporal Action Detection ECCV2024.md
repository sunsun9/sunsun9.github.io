---
layout: post
title: 'DyFADet: Dynamic Feature Aggregation for  Temporal Action Detection ECCV2024'
subtitle: '用于时间动作检测的动态特征融合'
date: 2025-03-02
author: Sun
cover: 'https://pic1.imgdb.cn/item/67c295eed0e0a243d408a44e.png'
tags: 论文阅读
---

> [DyFADet: Dynamic Feature Aggregation for  Temporal Action Detection](https://www.ecva.net/papers/eccv_2024/papers_ECCV/papers/06288.pdf)
> 
> 1 西安交通大学；
> 2 DAMO Academy阿里巴巴；
> 3  HKUST(GZ)；
> 4 清华大学

> 这篇文章提到的动态特征融合还是没有看明白，感觉这个结构什么的还是挺复杂的。

# 1.文章针对痛点

这篇文章仍然关注的任务是时间动作检测*TAD*。

文章认为最近提出的基于神经网络的时间动作检测（*TAD*　）模型本质上还是受限于**提取可区分性表示**和用**各种长度**来自复杂场景的共享权重检测头建模动作实例。

另外，**相邻帧之间的空间冗余性和静态特征提取策略会导致可学习表示的低区分性**，从而阻碍检测性能；另一方面，**检测头不适应问题出现在大部分TAD设计**，即使用一个静态权重共享头来检测多种时间长度动作实例，容易产生次优性能（可能还不是次优，局部最优）。

# 2.主要贡献

为了解决上面的问题，文章首先提出了一种**动态特征融合模块*Dynamic Feature Aggregation (DFA)***。1️⃣该模块在生成新特征时，可以基于输入调整卷积核形状、网络参数，这种动态过程明显不同于大部分TAD方法的静态特征学习过程。2️⃣该模块同时也增加了可学习特征的可区分性（主要是指动作与背景特征），也能够调整特征金字塔不同层检测头的特征学习过程。

基于*DFA*，**文章建立了动编码器和动态*TAD* 头**。前者能够促进目标动作特征聚合，并增加动作和边界特征之间的不同；后者可以调整检测器参数，当检测器被用于不同特征金字塔层检测不同长度的动作时。

# 3.实现流程

一样，还是先看一下原文展示的模型架构图：![模型架构图](https://pic1.imgdb.cn/item/67c2a988d0e0a243d408c3ed.png)

**根据文章描述，文章提出的*DyFADet* 架构包含一个视频特征*backbone*、一个编码器和两个检测头（分别是分类头和定位头）**

具体来说，模型首先使用一个预训练的*backbone* 来提取视频特征；之后提取的视频特征被送入编码器，生成特征金字塔；最后，特征金字塔的输入被融入两个检测头。

# 4.实现细节

* **动态特征融合模块*DFA*** ：这个模块的流程我其实没有太看懂，文章展示了这一部分的流程图，如下：![流程图](https://pic1.imgdb.cn/item/67c2a7aed0e0a243d408bf4b.png)1️⃣文章首先介绍了基于特征转移的*DFA*。**动态特征融合应该时需要能够根据输入来调整卷积核权重和感受野**，但是文章说到二者很难同时实现。但是文章想到了一种方法，就是一个普通的卷积是可以分解为一个特征转移模块（就是这个部分不太明白）和一个逐点的卷积。受到这个观点的启发，**文章提出可以学习一个基于输入的掩码，通过这个掩码将一部分权重置为0，另外一部分权重重新生成。**
  2️⃣文章还提到*DFA* 有多种不同的形式，这个好像是不同的重新生成权重的方式，文章列举了两种形式。![两种形式](https://pic1.imgdb.cn/item/67c2a886d0e0a243d408c302.png)
* **动态编码器**：在上面的架构图中，左下架构图就是这一模块的实施细节图。可以看到整体的架构就是将*SA* 模块换成了文章设计的*DynE* 模块。*DynE* 模块的实现包含两个分支，1️⃣一个是实例动态分支，这个分支的卷积核大小为1，用于生成全局时间权重掩码，帮助聚合全局动作信息。2️⃣另一个分支是具有不同的卷积核大小，也就是可以动态提出卷积核大小。这两个分支可以用下面公式1 2表示。最后得到的输出特征可以用公式3表示。

$$
\begin{aligned}
\boldsymbol{f}_{\mathrm{ins}} & =\mathrm{DFA_Conv}_1\left(\mathrm{Squeeze}(\mathrm{LN}(\mathrm{DS}(\boldsymbol{f})))\right) \quad（1）\\
\boldsymbol{f}_{\mathrm{k}} & =\mathrm{DFA_Conv}_{k,w}\left(\mathrm{LN}(\mathrm{DS}(\boldsymbol{f}))\right) \quad（2）
\end{aligned}
$$

$$
f_{\mathrm{dyn}}=f_{\mathrm{w}}+\boldsymbol{f}_{\mathrm{ins}}+\mathrm{DS}(\boldsymbol{f}) \quad（3）
$$

* 文章后面是关于检测头的介绍，这个部分主要是说怎么处理上一个模块传来的特征，也就是说在每一次生成当前金字塔层的内容是，不仅考虑金字塔的上一次输出，还考虑了金字塔上一次输出的相邻位置的结果，这个从架构图的*(c)* 可以看出来。但是其他的部分，还是没太懂。

# 5.模型性能

这篇文章的效果感觉和*TriDet* 没有差很多，但是整体结构上要复杂很多。选取了在两个主要使用数据集上的效果对比图：![效果对比图](https://pic1.imgdb.cn/item/67c3eb5dd0e0a243d4099cf1.png)

# 6.改进/挑战/问题/想法

* **想法**：这篇文章我觉得模型架构设计的相对来说比较复杂，收起是前面关于动态特征融合，这个部分没有看懂；其次，就是动态多尺度检测头这个我也不清楚动态体现在哪里。**但是这篇文章的效果话可以，那就说明这个问题确实是影响的，就是对于各种长度的动作实例，都使用相同的检测头对效果是有影响的。**

